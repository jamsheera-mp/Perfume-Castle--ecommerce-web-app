<%- include('../partials/user/header.ejs') %>

    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            <div class="col-3" style="padding-left: 0;">
                <aside class="navbar-aside bg-light"
                    style="height: 100vh; overflow-y: auto; box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);">
                    <div class="aside-top py-4 px-3 text-center">
                        <a href="/user/dashboard" class="brand-wrap">
                            <img src="/user/assets/imgs/logo/PCL_BS.jpg" class="logo img-fluid" alt="User Dashboard"
                                style="max-width: 150px;">
                        </a>
                    </div>
                    <nav class="mt-4">
                        <ul class="nav flex-column">
                            <li class="nav-item">
                                <a class="nav-link d-flex align-items-center" href="/user/profile">
                                    <i class="fas fa-user me-2"></i> <span>Profile Information</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link d-flex align-items-center" href="/address">
                                    <i class="fas fa-map-marker-alt me-2"></i> <span>Manage Addresses</span>
                                </a>
                                <ul class="nav flex-column ms-3">
                            <li class="nav-item"><a class="nav-link" href="/addAddress">Add New Address</a></li>
                            <li class="nav-item"><a class="nav-link" href="/editAddress">Edit Address</a></li>
                            <li class="nav-item"><a class="nav-link" href="/deleteAddress">Delete Address</a></li>
                        </ul>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link d-flex align-items-center" href="/orders">
                                <i class="fas fa-receipt me-2"></i> <span>My Orders</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link d-flex align-items-center" href="/wishlist">
                                <i class="fas fa-heart me-2"></i> <span>My Wishlist</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link d-flex align-items-center" href="/cart">
                                <i class="fas fa-shopping-cart me-2"></i> <span>My Cart</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link d-flex align-items-center" href="/transactions">
                                <i class="fas fa-money-check-alt me-2"></i> <span>Transactions</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link d-flex align-items-center" href="/profile/edit">
                                <i class="fas fa-edit me-2"></i> <span>Edit Profile</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link d-flex align-items-center text-danger" href="/logout">
                                <i class="fas fa-sign-out-alt me-2"></i> <span>Logout</span>
                            </a>
                        </li>
                        </ul>
                    </nav>
                </aside>
            </div>

            <!-- Main Content -->
            <div class="col-9">
                <div class="card " style="min-height: 600px;">
                    <main class="content" style="padding: 2rem;">
                        <h3>Manage Addresses</h3>
                        <div class="text-end mb-3">
                            <a class="btn btn-primary" id="addAddressBtn" onclick="toggleAddForm()">+ Add a New
                                Address</a>
                        </div>

                        <!-- add address form initially hide,after clicking add a new address,it will display-->
                        <div id="addAddressForm" class="add-address-form card mb-3"
                            style="max-width: 700px;display:none;">
                            <div class="card-body">


                                <form id="addressForm">
                                    <div class="mb-3">
                                        <button type="button" class="btn btn-primary"><i
                                                class="fas fa-map-marker-alt me-2"></i>Use my current location</button>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col-6">
                                            <input type="text" name="name" class="form-control" placeholder="Name"
                                                required>
                                            <div class="invalid-feedback">Please enter the name.</div>
                                        </div>
                                        <div class="col-6">
                                            <input type="text" name="phone" class="form-control"
                                                placeholder="10-digit mobile number" pattern="\d{10}" required>
                                            <div class="invalid-feedback">Please enter a valid 10-digit mobile number.
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col-6">
                                            <input type="text" name="pincode" class="form-control" placeholder="Pincode"
                                                pattern="\d{6}" required>
                                            <div class="invalid-feedback">Please enter a valid 6-digit pincode.</div>
                                        </div>
                                        <div class="col-6">
                                            <input type="text" name="city" class="form-control" placeholder="City/Town"
                                                required>
                                            <div class="invalid-feedback">Please enter the city/town.</div>
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <input type="text" name="landMark" class="form-control" placeholder="Landmark"
                                            required>
                                        <div class="invalid-feedback">Please enter a landmark.</div>
                                    </div>
                                    <div class="mb-3">
                                        <input type="text" name="district" class="form-control" placeholder="District"
                                            required>
                                        <div class="invalid-feedback">Please enter your district.</div>
                                    </div>
                                    <div class="mb-3">
                                        <select name="state" id="state" class="form-select" required>

                                            <option value="" selected disabled>--Select State--</option>
                                            <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands
                                            </option>
                                            <option value="Andhra Pradesh">Andhra Pradesh</option>
                                            <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                            <option value="Assam">Assam</option>
                                            <option value="Bihar">Bihar</option>
                                            <option value="Chandigarh">Chandigarh</option>
                                            <option value="Chhattisgarh">Chhattisgarh</option>
                                            <option value="Dadra and Nagar Haveli">Dadra and Nagar Haveli</option>
                                            <option value="Daman and Diu">Daman and Diu</option>
                                            <option value="Delhi">Delhi</option>
                                            <option value="Goa">Goa</option>
                                            <option value="Gujarat">Gujarat</option>
                                            <option value="Haryana">Haryana</option>
                                            <option value="Himachal Pradesh">Himachal Pradesh</option>
                                            <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                                            <option value="Jharkhand">Jharkhand</option>
                                            <option value="Karnataka">Karnataka</option>
                                            <option value="Kerala">Kerala</option>
                                            <option value="Ladakh">Ladakh</option>
                                            <option value="Lakshadweep">Lakshadweep</option>
                                            <option value="Madhya Pradesh">Madhya Pradesh</option>
                                            <option value="Maharashtra">Maharashtra</option>
                                            <option value="Manipur">Manipur</option>
                                            <option value="Meghalaya">Meghalaya</option>
                                            <option value="Mizoram">Mizoram</option>
                                            <option value="Nagaland">Nagaland</option>
                                            <option value="Odisha">Odisha</option>
                                            <option value="Puducherry">Puducherry</option>
                                            <option value="Punjab">Punjab</option>
                                            <option value="Rajasthan">Rajasthan</option>
                                            <option value="Sikkim">Sikkim</option>
                                            <option value="Tamil Nadu">Tamil Nadu</option>
                                            <option value="Telangana">Telangana</option>
                                            <option value="Tripura">Tripura</option>
                                            <option value="Uttar Pradesh">Uttar Pradesh</option>
                                            <option value="Uttarakhand">Uttarakhand</option>
                                            <option value="West Bengal">West Bengal</option>
                                        </select>
                                        <div class="invalid-feedback">Please select a state.</div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col-6">
                                            <input type="text" name="altPhone" class="form-control"
                                                placeholder="Alternate Phone (Optional)">
                                            <div class="invalid-feedback">Please enter a valid alternate phone number.
                                            </div>
                                        </div>
                                        <div class="col-6">
                                            <label for="addressType">Address Type</label>
                                            <select name="addressType" class="form-select" required>
                                                <option value="Home">Home</option>
                                                <option value="Work">Work</option>
                                            </select>
                                            <div class="invalid-feedback">Please select an address type.</div>
                                        </div>
                                    </div>
                                    <div class="d-flex justify-content-between">
                                        <button type="submit" id="saveAddressButton" class="btn btn-primary">Save
                                            Address</button>
                                        <button type="reset" class="btn btn-secondary"onclick="toggleAddForm()">Cancel</button>
                                    </div>
                                </form>
                            </div>
                        </div>


                        <!-- List of saved addresses -->

                        <div class="saved-addresses">
                            <% if(typeof addresses !=='undefined' && addresses.length> 0){ %>
                                <% addresses.forEach((addr, index)=> { %>
                                    <% addr.address.forEach((addressItem)=> { %>

                                        <div class="card mb-3" id="address-<%= addressItem._id %>">
                                            <div class="card-body d-flex justify-content-between">
                                                <div>
                                                    <span class="badge bg-secondary">
                                                        <%= addressItem.addressType %>
                                                    </span>
                                                    <p>
                                                        <strong>
                                                            <%= addressItem.name || 'No Name' %>
                                                        </strong>
                                                        <br>
                                                        <%= addressItem.phone %>
                                                            <br>
                                                            <%= addressItem.city %>, <%= addressItem.landMark %>,
                                                                    <%= addressItem.district %>, <%= addressItem.state
                                                                            %>,
                                                                            <strong>
                                                                                <%= addressItem.pincode %>
                                                                            </strong>
                                                    </p>
                                                </div>
                                                <div class="dropdown">
                                                    <a href="#" data-bs-toggle="dropdown"
                                                        class="btn btn-light rounded btn-sm font-sm">
                                                        <i class="material-icons md-more_horiz"></i>
                                                    </a>
                                                    <div class="dropdown-menu">
                                                        <a class="dropdown-item" href="javascript:void(0);"
                                                            onclick="toggleEditForm('<%= addressItem._id %>')">Edit</a>
                                                            <a class="dropdown-item text-danger" href="javascript:void(0);"
                                                             onclick="deleteAddress('<%= addressItem._id %>')">Delete</a>
                                                    </div>
                                                </div>

                                            </div>
                                            <div class="card mb-3 ps-2">
                                                <!-- Hidden Edit Form -->
                                                <div id="editForm-<%= addressItem._id %>" class="edit-form"
                                                    style="display: none;">
                                                    <form action="/editAddress/<%= addressItem._id %>" method="POST"
                                                        id="editAddressForm-<%= index %>"
                                                        onsubmit="submitEditForm('<%= index%>')"
                                                        >
                                                        <div class="row mb-3">
                                                            <div class="col-6">
                                                                <label for="name-<%= index %>" class="form-label">
                                                                    Name</label>
                                                                <input type="text" class="form-control"
                                                                    id="name-<%= index %>" name="name"
                                                                    value="<%= addressItem.name %>" required>
                                                                <div class="invalid-feedback">Please enter the name.
                                                                </div>
                                                            </div>
                                                            <div class="col-6">
                                                                <label for="phone-<%= index %>"
                                                                    class="form-label">Phone</label>
                                                                <input type="text" class="form-control"
                                                                    id="phone-<%= index %>" name="phone"
                                                                    value="<%= addressItem.phone %>" pattern="\d{10}"
                                                                    required>
                                                                <div class="invalid-feedback">Please enter a valid
                                                                    10-digit
                                                                    mobile number.</div>
                                                            </div>
                                                        </div>

                                                        <div class="row mb-3">
                                                            <div class="col-6">
                                                                <label for="pincode-<%= index %>"
                                                                    class="form-label">Pincode</label>
                                                                <input type="text" class="form-control"
                                                                    id="pincode-<%= index %>" name="pincode"
                                                                    value="<%= addressItem.pincode %>" pattern="\d{6}"
                                                                    required>
                                                                <div class="invalid-feedback">Please enter a valid
                                                                    6-digit
                                                                    pincode.</div>
                                                            </div>
                                                            <div class="col-6">
                                                                <label for="city-<%= index %>"
                                                                    class="form-label">City/Town</label>
                                                                <input type="text" class="form-control"
                                                                    id="city-<%= index %>" name="city"
                                                                    value="<%= addressItem.city %>" required>
                                                                <div class="invalid-feedback">Please enter the
                                                                    city/town.</div>
                                                            </div>
                                                        </div>

                                                        <div class="mb-3">
                                                            <label for="landmark-<%= index %>"
                                                                class="form-label">Landmark</label>
                                                            <input type="text" class="form-control"
                                                                id="landmark-<%= index %>" name="landMark"
                                                                value="<%= addressItem.landMark %>" required>
                                                            <div class="invalid-feedback">Please enter a landmark.</div>
                                                        </div>

                                                        <div class="mb-3">
                                                            <label for="district-<%= index %>"
                                                                class="form-label">District</label>
                                                            <input type="text" class="form-control"
                                                                id="district-<%= index %>" name="district"
                                                                value="<%= addressItem.district %>" required>
                                                            <div class="invalid-feedback">Please enter your district.
                                                            </div>
                                                        </div>

                                                        <div class="mb-3">
                                                            <label for="state-<%= index %>"
                                                                class="form-label">State</label>
                                                            <select name="state" id="state-<%= index %>"
                                                                class="form-select" required>
                                                                <option value="" selected disabled>--Select State--
                                                                </option>
                                                                <option value="Andaman and Nicobar Islands"
                                                                    <%=addressItem.state==="Andaman and Nicobar Islands"
                                                                    ? 'selected' : '' %>>Andaman and Nicobar Islands
                                                                </option>
                                                                <option value="Andhra Pradesh"
                                                                    <%=addressItem.state==="Andhra Pradesh" ? 'selected'
                                                                    : '' %>
                                                                    >Andhra Pradesh</option>
                                                                <option value="Arunachal Pradesh"
                                                                    <%=addressItem.state==="Arunachal Pradesh"
                                                                    ? 'selected' : '' %>
                                                                    >Arunachal Pradesh</option>
                                                                <option value="Assam" <%=addressItem.state==="Assam"
                                                                    ? 'selected' : '' %>>Assam</option>
                                                                <option value="Bihar" <%=addressItem.state==="Bihar"
                                                                    ? 'selected' : '' %>>Bihar</option>
                                                                <option value="Chandigarh"
                                                                    <%=addressItem.state==="Chandigarh" ? 'selected'
                                                                    : '' %>>Chandigarh</option>
                                                                <option value="Chhattisgarh"
                                                                    <%=addressItem.state==="Chhattisgarh" ? 'selected'
                                                                    : '' %>
                                                                    >Chhattisgarh</option>
                                                                <option value="Dadra and Nagar Haveli"
                                                                    <%=addressItem.state==="Dadra and Nagar Haveli"
                                                                    ? 'selected' : '' %>
                                                                    >Dadra and Nagar Haveli</option>
                                                                <option value="Daman and Diu"
                                                                    <%=addressItem.state==="Daman and Diu" ? 'selected'
                                                                    : '' %>
                                                                    >Daman and Diu</option>
                                                                <option value="Delhi" <%=addressItem.state==="Delhi"
                                                                    ? 'selected' : '' %>>Delhi</option>
                                                                <option value="Goa" <%=addressItem.state==="Goa"
                                                                    ? 'selected' : '' %>
                                                                    >Goa</option>
                                                                <option value="Gujarat" <%=addressItem.state==="Gujarat"
                                                                    ? 'selected' : '' %>>Gujarat</option>
                                                                <option value="Haryana" <%=addressItem.state==="Haryana"
                                                                    ? 'selected' : '' %>>Haryana</option>
                                                                <option value="Himachal Pradesh"
                                                                    <%=addressItem.state==="Himachal Pradesh"
                                                                    ? 'selected' : '' %>
                                                                    >Himachal Pradesh</option>
                                                                <option value="Jammu and Kashmir"
                                                                    <%=addressItem.state==="Jammu and Kashmir"
                                                                    ? 'selected' : '' %>
                                                                    >Jammu and Kashmir</option>
                                                                <option value="Jharkhand"
                                                                    <%=addressItem.state==="Jharkhand" ? 'selected' : ''
                                                                    %>>Jharkhand</option>
                                                                <option value="Karnataka"
                                                                    <%=addressItem.state==="Karnataka" ? 'selected' : ''
                                                                    %>>Karnataka</option>
                                                                <option value="Kerala" <%=addressItem.state==="Kerala"
                                                                    ? 'selected' : '' %>>Kerala</option>
                                                                <option value="Ladakh" <%=addressItem.state==="Ladakh"
                                                                    ? 'selected' : '' %>>Ladakh</option>
                                                                <option value="Lakshadweep"
                                                                    <%=addressItem.state==="Lakshadweep" ? 'selected'
                                                                    : '' %>>Lakshadweep</option>
                                                                <option value="Madhya Pradesh"
                                                                    <%=addressItem.state==="Madhya Pradesh" ? 'selected'
                                                                    : '' %>
                                                                    >Madhya Pradesh</option>
                                                                <option value="Maharashtra"
                                                                    <%=addressItem.state==="Maharashtra" ? 'selected'
                                                                    : '' %>>Maharashtra</option>
                                                                <option value="Manipur" <%=addressItem.state==="Manipur"
                                                                    ? 'selected' : '' %>>Manipur</option>
                                                                <option value="Meghalaya"
                                                                    <%=addressItem.state==="Meghalaya" ? 'selected' : ''
                                                                    %>>Meghalaya</option>
                                                                <option value="Mizoram" <%=addressItem.state==="Mizoram"
                                                                    ? 'selected' : '' %>>Mizoram</option>
                                                                <option value="Nagaland"
                                                                    <%=addressItem.state==="Nagaland" ? 'selected' : ''
                                                                    %>>Nagaland</option>
                                                                <option value="Odisha" <%=addressItem.state==="Odisha"
                                                                    ? 'selected' : '' %>>Odisha</option>
                                                                <option value="Puducherry"
                                                                    <%=addressItem.state==="Puducherry" ? 'selected'
                                                                    : '' %>>Puducherry</option>
                                                                <option value="Punjab" <%=addressItem.state==="Punjab"
                                                                    ? 'selected' : '' %>>Punjab</option>
                                                                <option value="Rajasthan"
                                                                    <%=addressItem.state==="Rajasthan" ? 'selected' : ''
                                                                    %>>Rajasthan</option>
                                                                <option value="Sikkim" <%=addressItem.state==="Sikkim"
                                                                    ? 'selected' : '' %>>Sikkim</option>
                                                                <option value="Tamil Nadu"
                                                                    <%=addressItem.state==="Tamil Nadu" ? 'selected'
                                                                    : '' %>>Tamil Nadu</option>
                                                                <option value="Telangana"
                                                                    <%=addressItem.state==="Telangana" ? 'selected' : ''
                                                                    %>>Telangana</option>
                                                                <option value="Tripura" <%=addressItem.state==="Tripura"
                                                                    ? 'selected' : '' %>>Tripura</option>
                                                                <option value="Uttar Pradesh"
                                                                    <%=addressItem.state==="Uttar Pradesh" ? 'selected'
                                                                    : '' %>
                                                                    >Uttar Pradesh</option>
                                                                <option value="Uttarakhand"
                                                                    <%=addressItem.state==="Uttarakhand" ? 'selected'
                                                                    : '' %>>Uttarakhand</option>
                                                                <option value="West Bengal"
                                                                    <%=addressItem.state==="West Bengal" ? 'selected'
                                                                    : '' %>>West Bengal</option>

                                                            </select>
                                                            <div class="invalid-feedback">Please select a state.</div>
                                                        </div>

                                                        <div class="row mb-3">
                                                            <div class="col-6">
                                                                <label for="altPhone-<%= index %>"
                                                                    class="form-label">Alternate
                                                                    Phone (Optional)</label>
                                                                <input type="text" class="form-control"
                                                                    id="altPhone-<%= index %>" name="altPhone"
                                                                    value="<%= addressItem.altPhone || '' %>">
                                                            </div>
                                                            <div class="col-6">
                                                                <label for="addressType">Address Type</label>
                                                                <select name="addressType" class="form-select" required>
                                                                    <option value="Home"
                                                                        <%=addressItem.addressType==='Home' ? 'selected'
                                                                        : '' %>>Home</option>
                                                                    <option value="Work"
                                                                        <%=addressItem.addressType==='Work' ? 'selected'
                                                                        : '' %>>Work</option>
                                                                </select>
                                                                <div class="invalid-feedback">Please select an address
                                                                    type.
                                                                </div>
                                                            </div>

                                                        </div>
                                                        <div class=.d-flex.justify-content-between>
                                                            <button id="saveEditBtn" type="submit" class="btn btn-primary">Save
                                                                Changes</button>
                                                            <button type="button" class="btn btn-secondary"
                                                                onclick="toggleEditForm('<%= addressItem._id %>')">Cancel</button>
                                                        </div>



                                                    </form>
                                                </div>
                                            </div>
                                            <% }) %>
                                                <% }) %>
                                                    <% } else { %>
                                                        <p>No addresses found.</p>
                                                        <% } %>
                                        </div>
                        </div>
                    </main>
                </div>
            </div>
        </div>

    </div>
    </div>


    <script>
        //add form validation
        // Client-side form validation
        (function () {
            'use strict';
            const form = document.getElementById('addressForm');
            const inputs = form.querySelectorAll('input, select');

            // Function to check if the field is valid
            function validateField(field) {
                if (field.checkValidity()) {
                    field.classList.remove('is-invalid');
                    field.classList.add('is-valid');
                } else {
                    field.classList.remove('is-valid');
                    field.classList.add('is-invalid');
                }
            }

            // Real-time validation on field input
            inputs.forEach(input => {
                input.addEventListener('input', function () {
                    validateField(input);
                });
            });

            // Validate on form submission
            form.addEventListener('submit', function (event) {
                let isFormValid = true
                // Loop over each field to check validity
                inputs.forEach(input => {
                    validateField(input);
                });

                if (!form.checkValidity()) {
                    isFormValid = false
                   
                }
                if(!isFormValid){
                    event.preventDefault();
                    event.stopPropagation()
                }
                form.classList.add('was-validated');
            }, false);
        })();

        //function to toggle the display of add form
        // Toggle add form visibility
        function toggleAddForm() {
            const form = document.getElementById('addAddressForm');
            form.style.display = form.style.display === 'none' ? 'block' : 'none';
        }

        // Handle form submission via AJAX
        document.getElementById('saveAddressButton').addEventListener('click', async function () {
            const formData = new FormData(document.getElementById('addressForm'));

            const response = await fetch('/addAddress', {
                method: 'POST',
                body: new URLSearchParams(formData), // Convert FormData to URLSearchParams for form encoding
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded'
                }
            });

            if (response.ok) {
                const data = await response.json();
                // Handle success: update the address list with the new address
                addAddressToList(data.address);
                toggleAddForm(); // Hide form after successful submission
            } else {
                // Handle error: show error message to the user
                alert('Error adding address. Please try again.');
            }
        });

        // function toggleAddForm() {
        //     const form = document.getElementById('addAddressForm');
        //     if (form.style.display === 'none' || form.style.display === '') {
        //         form.style.display = 'block';  // Show form
        //     } else {
        //         form.style.display = 'none';   // Hide form
        //     }
        // }



        
        // Toggle edit form visibility

        function toggleEditForm(addressId) {
            const editForm = document.getElementById(`editForm-${addressId}`);
            editForm.style.display = editForm.style.display === 'none' ? 'block' : 'none';
        }

        // Handle form submission via AJAX for editing address
        function submitEditForm(index) {
            const form = document.getElementById(`editAddressForm-${index}`);
            const formData = new FormData(form);

            fetch(form.getAttribute('action'), {
                method: 'POST',
                body: formData
                
            })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        // Successfully updated the address, now reflect changes on the page
                        updateAddressOnPage(index, data.address);
                        toggleEditForm(index); // Hide the form after success
                    } else {
                        alert('Error updating address. Please try again.');
                    }
                })
                .catch(error => console.error('Error:', error));
        }

        // Update address details on the page after successful edit
        function updateAddressOnPage(index, updatedAddress) {
            const addressElement = document.querySelector(`#editForm-${index}`).previousElementSibling;
            addressElement.querySelector('strong').innerText = updatedAddress.name || 'No Name';
            addressElement.querySelectorAll('p')[1].innerText = `${updatedAddress.city}, ${updatedAddress.landMark}, ${updatedAddress.district}, ${updatedAddress.state}, ${updatedAddress.pincode}`;
        }

//delete address
function deleteAddress(addressId) {
    if (confirm('Are you sure you want to delete this address?')) {
        fetch(`/deleteAddress/${addressId}`, {
            method: 'POST',
        })
        .then(response => response.json())
        .then(data => {
            console.log('server response',data);
            
            if (data.success) {
                alert(data.message);
                // Optionally remove the address from the UI
                const addressCard = document.querySelector(`#address-${addressId}`);
                if (addressCard) {
                    addressCard.remove(); // Remove the address card from the UI
                }
            } else {
                alert(data.message||'An error occured');
            }
        })
        .catch(error => console.error('Error:', error));
    }
}

        
    </script>
    <%- include('../partials/user/footer.ejs') %>